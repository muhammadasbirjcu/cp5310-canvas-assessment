<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>CP5310 Assessment 1</title>

        <!-- Bootstrap CSS Framework -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">

        <!-- Fontawesome Icons -->
        <script src="https://kit.fontawesome.com/54ebba3642.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="vh-100">
            <div id="toolbar" class="bg-primary bg-gradient px-3 py-2" style="height:50px">
                <div class="btn-group">
                    <button id="load-file" class="btn btn-light btn-sm"><i class="fa-solid fa-file"></i> Load</button>
                    <button id="save-file" class="btn btn-light btn-sm"><i class="fa-solid fa-floppy-disk"></i> Save</button>
                </div>

                <div class="btn-group">
                    <button id="clear-canvas" class="btn btn-light btn-sm"><i class="fa-solid fa-eraser"></i> Clear</button>
                    <button id="play-animation" class="btn btn-light btn-sm"><i class="fa-solid fa-play"></i> Play Animation</button>
                    <button id="stop-animation" class="btn btn-light btn-sm"><i class="fa-solid fa-stop"></i> Play Animation</button>
                </div>
            </div>
            <!-- <div id="background-guide"></div> -->
            <canvas id="main-canvas"></canvas>
        </div>


        
        <style type="text/css">
            /* clears all padding margin */
            *{
                padding:0;
                margin:0;
                box-sizing: border-box;
            }
            #main-canvas{
                height: 100%;
                width: 100%;
                border:0px none;
                display: block;

                position: relative;
                z-index: 9;
            }
            #background-guide{
                background: url(guide.png) center center no-repeat;
                position: fixed;
                top:0;
                left:0;
                width: 100%;
                height: 100%;
            }
            
        </style>
        <script>
            // set the default value
            const defaultValues = {
                circle: {
                    radius: 7,
                    fillColor: '#000'
                },
                line: {
                    width: 7
                }
            }

            const lastCoordinate = {
                x: null, y: null
            }

            const pointCoordinates = [               
                {x: 655, y: 351},
                {x: 715, y: 378},
                {x: 735, y: 408},
                {x: 750, y: 413},
                {x: 778, y: 395},
                {x: 781, y: 407},
                {x: 758, y: 426},
                {x: 737, y: 427},
                {x: 737, y: 448},
                {x: 733, y: 514},
                {x: 728, y: 556},
                {x: 728, y: 630},
                {x: 729, y: 660},
                {x: 661, y: 659},
                {x: 663, y: 622},
                {x: 654, y: 603},
                {x: 638, y: 587},
                {x: 551, y: 583},
                {x: 530, y: 592},
                {x: 518, y: 602},
                {x: 517, y: 620},
                {x: 512, y: 647},
                {x: 507, y: 663},
                {x: 447, y: 658},
                {x: 439, y: 648},
                {x: 439, y: 613},
                {x: 439, y: 564},
                {x: 400, y: 585},
                {x: 347, y: 591},
                {x: 299, y: 572},
                {x: 270, y: 525},
                {x: 260, y: 459}
            ];

            function plotCircle(context, centreX, centreY)
            {
                lastCoordinate.x = centreX;
                lastCoordinate.y = centreY;
                context.beginPath();
                context.arc(centreX, centreY, defaultValues.circle.radius, 0, 2*Math.PI);
                context.fillStyle = defaultValues.circle.fillColor;
                context.fill();
            }

            function drawLine(context, startX, startY, endX, endY)
            {
                context.beginPath();

                // create the line
                context.moveTo(startX, startY);
                context.lineTo(endX, endY);
                context.lineWidth = defaultValues.line.width;
                context.strokeStyle = createGradient(context, startX, startY, endX, endY);
                context.stroke();
            }

            function createGradient(context, startX, startY, endX, endY)
            {
                const grad = context.createLinearGradient(startX, startY, endX, endY);
                grad.addColorStop(0, "blue");
                grad.addColorStop(0.5, "red");
                grad.addColorStop(1, "yellow");
                return grad;
            }

            function saveToFile(points)
            {
                location.href = "data:application/octet-stream," + encodeURIComponent(JSON.stringify(points));
            }

            function drawPoints(points)
            {
                for(var i in pointCoordinates){
                    plotCircle(canvasContext, pointCoordinates[i].x, pointCoordinates[i].y);
                    if(i > 0){
                        drawLine(canvasContext, pointCoordinates[i-1].x, pointCoordinates[i-1].y, pointCoordinates[i].x, pointCoordinates[i].y);
                    }
                }
            }

            function clearCanvas(context, canvas)
            {
                context.clearRect(0, 0, canvas.width, canvas.height);
            }

            const canvas = document.getElementById("main-canvas");
            const canvasContext = canvas.getContext('2d');

            // this part make sure the canvas covers the whole viewport/window
            var toolbarHeight = 50;
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight - toolbarHeight;

            // draw pointCoordinates
            drawPoints(pointCoordinates);

            // bind listeners
            document.getElementById("save-file").addEventListener("click", function(event) {
                saveToFile(pointCoordinates);
            });
            document.getElementById("clear-canvas").addEventListener("click", function(event) {
                if(confirm("Are you sure you want to clear?")){
                    clearCanvas(canvasContext, canvas);
                }
            });

            // listen to clicks
            // canvas.addEventListener("click", function(event) {
            //     if(lastCoordinate.x == null){
            //         plotCircle(canvasContext, event.offsetX, event.offsetY);
            //     }else{
            //         drawLine(canvasContext, lastCoordinate.x, lastCoordinate.y, event.offsetX, event.offsetY);
            //         plotCircle(canvasContext, event.offsetX, event.offsetY);
            //     }
            //     console.log(lastCoordinate);
            // });
            
            // plotCircle(canvasContext, 7, 7);
            // drawLine(canvasContext, 7, 7, 40, 40);
            // plotCircle(canvasContext, 40, 40);
            // drawLine(canvasContext, 40, 40, 40, 60);


        </script>
    </body>
</html>
